---
layout:     post
title:      "gmx 分子间相互作用分析"
subtitle:   ""
date:       2020-05-03 19:15:00
author:     "XiLock"
header-img: ""
header-mask: 0.3
catalog:    true
tags:
    - 《斤竹精舍·游艺集》
    - GMX学习记录
    - 2020

---

**为方便学习、使用，将资料整理至此，感谢sob老师的指导**

### 相互作用能分析

参考资料：
1. [使用GROMACS计算分子间相互作用](https://jerkwin.github.io/2019/09/06/%E4%BD%BF%E7%94%A8GROMACS%E8%AE%A1%E7%AE%97%E5%88%86%E5%AD%90%E9%97%B4%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8/)
1. [提取 GMX 轨迹中两个 group 之间的静电和范德华相互作用](https://blog.chembiosim.com/extract-vdw-elec-in-gmx/)
1. [《平均力势----以石墨烯-甘氨酸体系为例》附录部分](https://liuyujie714.com/41.html)

步骤：
1. 分别提取分子A、分子B和分子A-B的xtc轨迹及gro文件；
1. 利用gro文件生成分子A、分子B和分子A-B的tpr文件；（理论上可以通过convet-tpr实现，但可能因为原tpr中能量组、温度组等的设置而出现问题，所以建议重新生成tpr文件）
1. 利用xtc来-rerun分子A、分子B和分子A-B的tpr，命令如：`gmx mdrun -v -deffnm lys -rerun lys.xtc`；
1. 将分子A-B的LJ(SR)+Coulomb(SR)+LJ.Disp+Coulomb.recip减去分子A和分子B的.


### 弱相互作用分析
分子来分子间的作用就都是弱相互作用。首先推荐几个sob老师的实例
1. [探究18碳环独特的分子间相互作用与pi-pi堆积特征](http://sobereva.com/572)：充分灵活运用Multiwfn程序做了大量分析，使得弱相互作用的本质被研究得深入透彻，给讨论提供了丰富得多的视角.其原文Carbon, 171, 514-523 (2021)中系统地研究了18碳环的分子间相互作用问题，
1. [使用PSI4做对称匹配微扰理论(SAPT)能量分解计算](http://sobereva.com/526)

**化学体系中的相互作用主要分为“化学键作用”和“弱相互作用”两大类(参考：[谈谈“计算时是否需要加DFT-D3色散校正？”](http://sobereva.com/413)).**  
1. 从相互作用能上看，“化学键作用”一般强度比较强，共价键和离子键都属于此类，也可以叫强相互作用；
1. “弱相互作用”一般强度比较弱，比前者通常弱一个数量级.弱相互作用既可以是分子间的，也可以是分子内的.弱相互包括范德华作用、pi-pi堆积作用、氢键、二氢键、卤键，以及后来很多人炒作概念而提出来的碳/硫/磷/金/银/铜...键等等.

还有个词叫做非共价相互作用（noncovalent interaction），这个词的范畴相当于弱相互作用和离子键的并集.

弱相互作用形式多样，但主要本质只有两个，即静电相互作用、色散相互作用，此外还有一个交换互斥：
1. 静电相互作用：可以起到互斥作用也可以起到吸引作用，看具体情况（体系、相对位置）.这里说的静电相互作用也把极化作用包含进去了.
1. 色散作用：起吸引作用，必须从量子力学角度才能予以解释.而从量化理论角度来讲，它对应于电子的长程的库仑相关作用.
1. 交换互斥：它起到互斥作用，不管算什么类型相互作用都要考虑这个，只有在较近距离（比如小于两个原子的范德华半径和）的时候才开始凸显出来，且原子间距离越近此作用越大.正是这个作用使得弱相互作用的势能曲线总是有极小点，而不会令原子间距离因为静电吸引和色散作用而无限减小.
一般强度的氢/二氢/卤/硫/磷键等等是以静电吸引主导，色散作用为辅构成的，这点通过能量分解也可以体现出来.而一般说的范德华相互作用，以及pi-pi堆积作用的本质都是色散作用.

注：
1. “范德华作用”这个词描述的是电中性的两个原子之间的非共价相互作用，故本质包含了交换互斥和色散吸引作用两个部分.这个词可以囊括比如两个氩原子间的相互作用的全部内涵.这个词也可以用来描述无极性分子间的全部相互作用（但实际上，没有绝对严格意义的无极性分子，比如就连一般说的无极性分子氮气也有四极矩，可以认为是局部极性，因此氮气之间也有静电相互作用，讨论见[静电效应主导了氢气、氮气二聚体的构型](http://sobereva.com/209).但本文就不咬文嚼字了）.至于一些初级的教材里说的范德华作用包括“诱导力、色散力、取向力”，这种歪曲的说法应该彻底从量化研究者的脑海中删除.
1. 范德华作用中互斥项来自于交换互斥作用，起到吸引作用的色散项虽然本质上来自于电子间的1/r12算符（r12=电子间距离），但表现出来的是1/R^6的渐进行为（R=原子间距离），体现出的电子相关作用，某种意义上可以称“动态”作用，属于量子效应，没法按照经典电动力学方式解释。而一般说的静电作用则是电子“静态”分布对应的相互作用，可以按照经典电动力学来计算。参考[静电作用与范德华作用](http://bbs.keinsci.com/thread-3608-1-1.html)
1. 弱相互作用实际上也伴随着一些共价作用，但共价作用此时仅仅是个“陪衬”而已，对弱相互作用能贡献程度极小，故在弱相互作用范畴里不需要专门特意考虑（但是弱相互作用范畴里面也有强度很大的情况，比如能到100kJ/mol数量级的氢键，此时共价作用就不能忽视了，此文说的弱相互作用不考虑此情况）.
1. sob强烈建议仔细看一下[《透彻认识氢键本质、简单可靠地估计氢键强度：一篇2019年JCC上的重要研究文章介绍》](http://sobereva.com/513)和其中提到的原文，对于正确认识氢键的作用本质极有益处.
1. 氢键可以读一下这篇文章[《The hydrogen bond in the solid state》(Steiner Thomas.Angewandte Chemie International Edition 41.1 (2002): 48-76.)](https://www.sci-hub.ru/10.1002/1521-3773(20020104)41:1%3C48::aid-anie48%3E3.0.co;2-u)
1. pi-pi作用是相距较近的两个片段上彼此朝向相对的pi电子之间的独特的色散吸引作用。参考[谈谈pi-pi相互作用](http://sobereva.com/737)
1. 原子间相互作用从物理本质上可以基本分为静电、色散、交换、Pauli互斥、轨道相互作用。
1. 一般量化计算中说的交换能和能量分解中常说的交换互斥(exchange repulsion)能的本质都在于Pauli反对称原理推得的Pauli互斥原理，它使得具有相同自旋的电子在空间中相互回避，平均距离增加，如同有某种互斥力（有时被称为Pauli斥力），导致它们之间静电互斥能减小。但二者的现象、涉及的问题不同。一般计算单个分子时，交换能使体系能量降低，这也正是Hartree-Fock能量低于Hartree能量的原因。而交换互斥是指当两个原子接近时，相互电子云开始重叠，两原子上相同自旋的电子由于Pauli互斥原理的作用，导致电子密度在原子间减小，因此电子云对核-核互斥能屏蔽减弱，使两原子间核互斥能增加，总体系能量升高。参考[杂谈交换互斥(exchange repulsion)作用](http://sobereva.com/58)
1. 推荐资料：[《Density functional theory with London dispersion corrections》](https://wires.onlinelibrary.wiley.com/doi/10.1002/wcms.30)、[《Intermolecular Interactions: Physical Picture, Computational Methods and Model Potentials》](https://baike.baidu.com/item/%E5%88%86%E5%AD%90%E9%97%B4%E7%9B%B8%E4%BA%92%E4%BD%9C%E7%94%A8%E2%80%94%E2%80%94%E7%89%A9%E7%90%86%E5%9B%BE%E5%83%8F%E3%80%81%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%E4%B8%8E%E6%A8%A1%E5%9E%8B%E5%8A%BF%E8%83%BD/16820037)(国内翻译版叫《分子间相互作用》，虽然翻译得不算理想。英文版网上也有电子版。注意这书里很多关于计算方法的讨论已经过时了，但对物理本质的讨论还不错。)

###### Sobereva老师的教程
汇总了一下Sobereva老师的弱相互作用分析部分的内容，以便查看：  
1. [Multiwfn支持的弱相互作用的分析方法概览](http://sobereva.com/252)
1. [使用Multiwfn研究分子动力学中的弱相互作用](http://sobereva.com/186)
1. [使用Multiwfn图形化研究弱相互作用](http://sobereva.com/68)
1. [用Multiwfn+VMD做RDG分析时的一些要点和常见问题](http://sobereva.com/291)
1. [绘制有填色效果的用于弱相互作用分析的RDG散点图的方法](http://sobereva.com/399)
1. [通过独立梯度模型(IGM)考察分子内和分子间的弱相互作用](http://sobereva.com/407)
1. [大体系弱相互作用计算的解决之道](http://sobereva.com/214)


###### Ligplot+
网站：[链接](https://www.ebi.ac.uk/thornton-srv/software/LigPlus/download2.html)  
注意：
1. Ligplot+基于java，可能需要安装java.
1. 初始化时设置的“Temporary directory”路径的文件夹必须存在，否则会报错.
1. edu邮箱注册后获取下载链接及密码.

### 分子力场能量分解
1. [使用Multiwfn做基于分子力场的能量分解分析](http://sobereva.com/442)



![](/img/wc-tail.GIF)

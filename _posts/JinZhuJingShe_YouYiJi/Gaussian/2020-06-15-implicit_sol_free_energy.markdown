---
layout:     post
title:      "Gaussian 溶解自由能·溶解度"
subtitle:   ""
date:       2020-06-15 20:38:00
author:     "XiLock"
header-img: ""
header-mask: 0.3
catalog:    true
tags:
    - 《斤竹精舍·游艺集》
    - Gaussian
    - 2020

---

### 隐式模型下溶解自由能及溶剂下自由能计算

$$溶剂下的自由能=溶解自由能+气相的自由能$$

用M052X/6-31G* scrf=(smd,solvent=dichloromethane)的单点能减去M052X/6-31G*的单点能，得到溶解自由能，加到热力学组合方法算的气相自由能上，得到溶剂下的自由能。

更精确的做法为：

1. 恰当的级别诸如B3LYP/6-311G**优化，并且做振动分析，得到自由能的热力学校正量delta_Gcorr
2. M05-2X/6-31G*计算1结构的气相和带着scrf=SMD的单点能（SCF Done后面的值），二者求差，得到溶解自由能delta_Gsolv
3. 用高精度级别诸如B2PLYP-D3/def2-TZVP计算1结构的气相单点能
4. 将3的能量与delta_Gcorr和delta_Gsolv相加就完了。

```
用# M052X/6-31G* scrf(SMD,solvent=xxxx,read)，这里xxx是与你考察的那个溶剂分子在高斯支持的溶剂列表当中结构特征最接近的溶剂，即非极性部分套用它的参数。末尾空一行写
eps=yyy
dis
rep
cav
```
这里yyy是你的溶剂的介电常数。这么算出单点能后，去掉scrf，再算一次。和刚才的求差，就是溶解自由能。


### 注意
1. 溶解度的差异可以通过在两种溶剂中的溶解自由能的不同来体现，而且在两种溶剂间的分配系数可以通过溶解自由能的差异直接得到.但溶解自由能不是决定是否溶解的唯一因素.最理想、严格的考察方法是做分子动力学,但是体系必须建得很大，否则统计误差会很大。.
1. 除非非常懂溶剂模型或者有极其特殊的目的，否则就用SMD就完了，零零碎碎的事都不用操心。
1. 使用SMD隐式溶剂模型计算溶质的单点能时（为了研究溶质阴阳离子间相互作用力），计算级别应该选用高精度的级别,仅仅专门计算溶解自由能这一步才适合M05-2X/6-31G*.
1. 对于反应“A+B--> C+H2O”，在气相下优化A+B复合物并做振动分析，得到气相下自由能，然后在这个优化好的结构下计算溶剂化自由能（带着溶剂模型和不带情况下的单点能的差值），将二者相加，即是溶剂下的自由能。对于H2O+C也这么计算。最后将反应物和产物求差即可。
1. 自由能计算考虑BSSE是完全多余的，如果怀疑SMD对当前问题不合适，就用默认的IEFPCM，没有SMD那样的经验参数，但SMD和IEFPCM的差异导致结果不合理的可能性很低.
1. 质子溶解自由能通过现有溶剂模型无法算准，应当直接用最佳的推测值，见J. Phys. Chem. B, 110, 16066。实际上此文中是对Tissandier的J. Phys. Chem. A, 102, 7787 (1998)的数据进行验证，即最早来源是1998年这篇JPCA。这个数据是目前计算最常用的质子的溶解自由能。
1. 溶剂对结构的影响很小，是否在溶剂下优化都无所谓，但毕竟耗时增加很少，还是建议这么做。
1. 溶剂化自由能计算过程中的熵校正是多于的。
1. 对于非极性溶剂，eps=epsinf=折射率的平方 是个不错的近似.

参考阅读：  
1. [keinsci - 计算溶剂下吉布斯自由能](http://bbs.keinsci.com/thread-2289-1-1.html)
1. [keinsci - 读完博文“谈谈隐式溶剂模型下溶解自由能和体系自由能的计算”后几个问题的请教](http://bbs.keinsci.com/thread-10535-1-1.html)
1. [keinsci - 反应过程吉布斯自由能](http://bbs.keinsci.com/thread-7054-1-1.html)
1. [keinsci - 求助于氢离子的能量计算和吉布斯自由能校正项的计算](http://bbs.keinsci.com/thread-13515-1-1.html)
1. [keinsci - 审稿意见求助，关于溶液中熵校正问题](http://bbs.keinsci.com/thread-20248-1-1.html)
1. [keinsci - 溶剂溶解度能否比较？](http://bbs.keinsci.com/thread-11016-1-1.html)
1. [keinsci - 高斯计算溶剂化自由能时自定义溶剂遇到的问题](http://bbs.keinsci.com/thread-3544-1-1.html)
1. [求助-关于orca的溶剂化模型](http://bbs.keinsci.com/thread-13117-1-1.html)


### QM和MD计算溶剂化自由能的比较
MD的底层理论简陋，QM无法进行充分采样。MD的好处还是在于其较小的计算开销，能够处理显式溶剂、大体系（蛋白质）、长时间采样，在显卡加速和多核计算加持下计算速度远远优于高精度QM，尤其是对于蛋白质体系，QM几乎是无法处理的，虽然也有多精度组合方法的QM，但是操作过于复杂，怎样划分不同精度处理的界限也是难题。对于蛋白质与配体的结合自由能处理应该首先考虑MD方法。

参考阅读:
1. [结合自由能计算：MD vs. QM](http://bbs.keinsci.com/thread-13377-1-1.html) 
1. [HYDROPHOBE Challenge: A Joint Experimental and Computational Study on the Host–Guest Binding of Hydrocarbons to Cucurbiturils, Allowing Explicit Evaluation of Guest Hydration Free-Energy Contributions](https://pubs.acs.org/doi/abs/10.1021/acs.jpcb.7b09175)

### 溶解度
###### 卡卡开发
看是何种物态的有机物，大体有以下情形比较好处理：  
1.1、若体系为气态分子溶解为溶液，溶解度确实直接和溶解自由能有关.严格说起来对于气态分子溶剂化自由能和溶解度可以与平衡常数建立关系，从而很自然而然导出溶解度和溶剂化能的关系.
1.2、若体系单组分的有序晶体溶解为溶液，且溶质不明显电离，你可以把固体溶解的过程看成固体先升华到气体，气体再溶解为溶质。此时不光和溶剂化自由能有关，还和晶格的形成自由能有关。晶体的溶解，可以设计Born-Haber循环，然后也能导出溶解度和总自由能=溶解自由能+晶格形成自由能（或者也可以叫晶格的升华自由能）.

不太好处理的情况：
2.1、若形成的溶液是浓电解质溶液，会涉及到活度系数方面的问题，可能需要一定修正。
2.2、既不是气体也不是晶体的情况本身通过量子化学方法就不太容易解决。涉及到多个分子相互作用，而且较为无序，势能面结构也很复杂。比如一些液体和非晶体，无序性比较强，自由能接近的构象也很多，这些构象转换也不困难，很难单一通过优化结构做理想气体近似或者固体近似来获得热力学量.这种情况可能需要动用分子动力学的方法，或者特定的构象搜索方法.
2.3、如溶质本身就是液体或者多个组分或者存在很复杂的平衡。此时溶解度公式本身导出就很复杂，还需要逐一计算涉及到的过程对应的自由能，这样才能算出溶解度。
这些研究这些体系的文章估计多半也就找几个主要因素讨论一下对溶解度的影响。
2.4、涉及到复杂化学作用会导致有复杂的化学过程，首先溶解度的关系不容易得到，其次是有些平衡常数很难算准。
2.5、 一般单组分的液体，如果分子之间作用不是太复杂倒是也可能用连续介质模型定性正确描述；但是如果涉及到氢键等比较显著的作用，这些就是2.1情形提到的了.

溶解度比较难算，对自由能计算的精度非常敏感，比如1.2的情形，总自由能1kJ/mol的偏差足以导致lgS有0.175个unit左右的偏差，但连续介质模型有时候偏差能够达到4~8kcal/mol，若非误差抵消恐怕很难得到好结果。

###### sob
Q:计算不同有机溶质分子在水中的溶解度对比，具体是通过计算什么来表征溶解度的？  
A:计算蒸发自由能，以及溶解自由能，二者加和，可以考察溶解过程自由能的变化，由此可衡量溶解能力.溶解自由能可以用FEP方法，这里有例子http://www.mdtutorials.com/gmx/free_energy/index.html（是否靠谱我不确定，我没仔细看过）.算蒸发焓的文章很多，随便一搜就有，比如很多水模型的文章里都有计算。然后再把-T*deltaS考虑进去就完了.
Q: 请问为什么还要算蒸发自由能？直接用溶解自由能deltG=-RTlnK来计算平衡常数可以吗？蒸发自由能是要怎么算呢？
A: 溶解自由能一般说的是单个分子溶解过程的自由能变化，而一个固体打散成单个分子过程的自由能变化对应于蒸发自由能。从热力学循环的角度来说固体的溶解过程的自由能变是二者的加和。算的方式多搜搜肯定找得到.

sob:可以在盒子一侧一次加很多CO2，如果CO2非常多的话，体系应该会呈现气液界面，然后去统计液相区域里平均有CO2，就可以换算出溶解度.

###### 参考阅读：
1. [简单量子化学问题答疑专帖：溶解度](http://bbs.keinsci.com/thread-806-288-1.html)(Q:不同溶剂的缔合氢键的键能可以通过隐式溶剂模型？)
1. [keinsci - 怎样使用gmx计算有机分子在水中的溶解度？](http://bbs.keinsci.com/thread-7463-1-1.html)
1. [keinsci - 如何模拟计算季铵盐在水中的溶解度？](http://bbs.keinsci.com/thread-21584-1-1.html)
1. [keinsci - 求助CO2在ChCl-EG溶剂体系中的溶解度的计算](http://bbs.keinsci.com/thread-13738-1-1.html)
 
### 参考阅读：
1. [sob - 隐式溶剂模型下溶解自由能和体系自由能的计算](http://bbs.keinsci.com/thread-3345-1-1.html)
1. [sob - 通过SMD溶剂模型描述离子液体溶剂环境的方法](http://sobereva.com/431)
1. [keinsci - 离子溶质溶解自由能](http://bbs.keinsci.com/thread-11545-1-1.html)
1. [keinsci - 热力学计算的溶剂化效应是如何考虑电解质的影响的](http://bbs.keinsci.com/thread-3686-1-1.html)
1. [keinsci - 求教如何算介电常数？](http://bbs.keinsci.com/thread-9433-1-1.html)

![](/img/wc-tail.GIF)
